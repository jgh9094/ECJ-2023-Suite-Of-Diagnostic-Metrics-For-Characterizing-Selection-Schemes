# Ordered exploitation results

Here we present the results for **best performances** found by each selection scheme on the ordered exploitation diagnostic with valley crossing integrated.
50 replicates are conducted for each scheme explored.


## Analysis dependencies

```{r ord-libs, message=FALSE}
library(ggplot2)
library(cowplot)
library(dplyr)
library(PupillometryR)
```

## Data setup

```{r ord-data-setup, message=FALSE}
DIR = paste(DATA_DIR,'ORDERED_EXPLOITATION/', sep = "", collapse = NULL)
over_time_df <- read.csv(paste(DIR,'over-time.csv', sep = "", collapse = NULL), header = TRUE, stringsAsFactors = FALSE)
over_time_df$scheme <- factor(over_time_df$scheme, levels = NAMES)

best_df <- read.csv(paste(DIR,'best.csv', sep = "", collapse = NULL), header = TRUE, stringsAsFactors = FALSE)
best_df$acro <- factor(best_df$acro, levels = ACRO)
```

## Performance over time

Best performance in a population over time.
Data points on the graph is the average performance across 50 replicates every 2000 generations.
Shading comes from the best and worse performance across 50 replicates.


```{r ord-per-ot, warning=FALSE}
lines = over_time_df %>%
  group_by(scheme, gen) %>%
  dplyr::summarise(
    min = min(pop_fit_max) / DIMENSIONALITY,
    mean = mean(pop_fit_max) / DIMENSIONALITY,
    max = max(pop_fit_max) / DIMENSIONALITY
  )

over_time_plot = ggplot(lines, aes(x=gen, y=mean, group = scheme, fill = scheme, color = scheme, shape = scheme)) +
  geom_ribbon(aes(ymin = min, ymax = max), alpha = 0.1) +
  geom_line(size = 0.5) +
  geom_point(data = filter(lines, gen %% 2000 == 0 & gen != 0), size = 1.5, stroke = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score",
    limits=c(0, 15),
  ) +
  scale_x_continuous(
    name="Generations",
    limits=c(0, 50000),
    breaks=c(0, 10000, 20000, 30000, 40000, 50000),
    labels=c("0e+4", "1e+4", "2e+4", "3e+4", "4e+4", "5e+4")

  ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette) +
  scale_fill_manual(values = cb_palette) +
  ggtitle('Performance over time')+
  p_theme + theme(legend.title=element_blank(),legend.text=element_text(size=12)) +
  guides(
    shape=guide_legend(ncol=2, title.position = "bottom"),
    color=guide_legend(ncol=2, title.position = "bottom"),
    fill=guide_legend(ncol=2, title.position = "bottom")
  )

over_time_plot
```

```{r ord-legend, echo=FALSE}
legend <- cowplot::get_legend(
  over_time_plot +
    guides(
    shape=guide_legend(ncol=2, title.position = "bottom"),
    color=guide_legend(ncol=2, title.position = "bottom"),
    fill=guide_legend(ncol=2, title.position = "bottom")
    ) +
    theme(
      legend.position = "top",
      legend.box="verticle",
      legend.justification="center"
    )
)
```

## Best performance throughout

Best performance reached throughout 50,000 generations in a population.


```{r ord-per-bst}
plot = filter(best_df, var == 'pop_fit_max') %>%
  ggplot(., aes(x = acro, y = val / DIMENSIONALITY, color = acro, fill = acro, shape = acro)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
  scale_y_continuous(
    name="Average trait score"
  ) +
  scale_x_discrete(
    name="Scheme"
  )+
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = cb_palette, ) +
  scale_fill_manual(values = cb_palette) +
  ggtitle('Best performance throughout')+
  p_theme + theme(legend.title=element_blank())

plot_grid(
  plot +
    theme(legend.position="none"),
  legend,
  nrow=2,
  rel_heights = c(3,1)
)
```

### Stats

Summary statistics for the best performance.

```{r ord-per-sum}
performance = filter(best_df, var == 'pop_fit_max')
performance$acro = factor(performance$acro, levels = c('gfs','pfs','tru','tor','lex','nov','nds','ran'))
performance %>%
  group_by(acro) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(val)),
    min = min(val / DIMENSIONALITY, na.rm = TRUE),
    median = median(val / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(val / DIMENSIONALITY, na.rm = TRUE),
    max = max(val / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(val / DIMENSIONALITY, na.rm = TRUE)
  )
```

Kruskalâ€“Wallis test illustrates evidence of statistical differences.

```{r ord-per-kru}
kruskal.test(val ~ acro, data = performance)
```

Results for post-hoc Wilcoxon rank-sum test with a Bonferroni correction.

```{r ord-per-wil}
pairwise.wilcox.test(x = performance$val, g = performance$acro, p.adjust.method = "bonferroni",
                     paired = FALSE, conf.int = FALSE, alternative = 'l')
```



## Performance interval comparison

Here we compare the best performance found in the population at generation 40,000 & 50,000 for all selection schemes.

```{r ord-per-cmp}
interval_df = filter(filter(over_time_df, (gen == 50000 | gen == 40000)))
interval_df$Generation <- factor(interval_df$gen, levels = c(40000,50000))
interval_df$acro <- factor(interval_df$acro, levels = ACRO)

ggplot(interval_df, aes(x=acro, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_boxplot(width = .3, outlier.shape = NA, alpha = 0.0) +
  geom_point(size = 1.0, alpha = 1.0, position=position_dodge(width=1.0)) +
    scale_y_continuous(
      name="Average trait score"
    ) +
    scale_x_discrete(
      name="Scheme"
    ) +
  scale_shape_manual(values=SHAPE)+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme
```

### Stats by interval comparisons

Here we present statistical analysis between the performances found at different generation intervals.

#### Truncation

Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-tru}
filter(interval_df, acro == 'tru') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-tru}
filter(interval_df, acro == 'tru') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-tru}
wilcox.test(x = filter(interval_df, acro == 'tru' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'tru' & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

#### Tournament

Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-tor}
filter(interval_df, acro == 'tor') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-tor}
filter(interval_df, acro == 'tor') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-tor}
wilcox.test(x = filter(interval_df, acro == 'tor' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'tor' & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

#### Lexicase

Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-lex}
filter(interval_df, acro == 'lex') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-lex}
filter(interval_df, acro == 'lex') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-lex}
wilcox.test(x = filter(interval_df, acro == 'lex' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'lex' & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

#### Genotypic fitness sharing


Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-gfs}
filter(interval_df, acro == 'gfs') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-gfs}
filter(interval_df, acro == 'gfs') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-gfs}
wilcox.test(x = filter(interval_df, acro == 'gfs' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'gfs' & Generation == 40000)$pop_fit_max,
            alternative = 'g')
```

#### Phenotypic fitness sharing


Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-pfs}
filter(interval_df, acro == 'pfs') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-pfs}
filter(interval_df, acro == 'pfs') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-pfs}
wilcox.test(x = filter(interval_df, acro == 'pfs' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'pfs' & Generation == 40000)$pop_fit_max,
            alternative = 'g')
```

#### Nondominated sorting


Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-nds}
filter(interval_df, acro == 'nds') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-nds}
filter(interval_df, acro == 'nds') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-nds}
wilcox.test(x = filter(interval_df, acro == 'nds' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'nds' & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

#### Novelty search


Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-nov}
filter(interval_df, acro == 'nov') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-nov}
filter(interval_df, acro == 'nov') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-nov}
wilcox.test(x = filter(interval_df, acro == 'nov' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'nov' & Generation == 40000)$pop_fit_max,
            alternative = 't')
```

#### Random


Plot for comparing performances at interval 40,000 & 50,000.

```{r ord-per-cmp-plt-ran}
filter(interval_df, acro == 'ran') %>%
ggplot(., aes(x=Generation, y=pop_fit_max/DIMENSIONALITY,fill=Generation,color=Generation,shape=Generation)) +
  geom_flat_violin(position = position_nudge(x = .09, y = 0), scale = 'width', alpha = 0.2, width = 1.5) +
  geom_boxplot(color = 'black', width = .07, outlier.shape = NA, alpha = 0.0, size = 1.0, position = position_nudge(x = .15, y = 0)) +
  geom_point(position = position_jitter(width = .02), size = 2.0, alpha = 1.0) +
    scale_y_continuous(
      name="Average trait score",
    ) +
    scale_x_discrete(
      name="Generation"
    ) +
  scale_shape_manual(values=c(16,16))+
  scale_colour_manual(values = mvc_col, ) +
  scale_fill_manual(values = mvc_col) +
  ggtitle('Performance comparisons')+
  p_theme + theme(legend.position="none")
```

Summary statistics for the best performance.

```{r ord-per-cmp-sum-ran}
filter(interval_df, acro == 'ran') %>%
  group_by(Generation) %>%
  dplyr::summarise(
    count = n(),
    na_cnt = sum(is.na(pop_fit_max)),
    min = min(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    median = median(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    mean = mean(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    max = max(pop_fit_max / DIMENSIONALITY, na.rm = TRUE),
    IQR = IQR(pop_fit_max / DIMENSIONALITY, na.rm = TRUE)
  )
```


Results for post-hoc Wilcoxon rank-sum test.

```{r ord-per-cmp-wil-ran}
wilcox.test(x = filter(interval_df, acro == 'ran' & Generation == 50000)$pop_fit_max,
            y = filter(interval_df, acro == 'ran' & Generation == 40000)$pop_fit_max,
            alternative = 't')
```